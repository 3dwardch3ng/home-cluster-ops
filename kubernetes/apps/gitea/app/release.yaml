apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: gitea
  namespace: gitea
spec:
  targetNamespace: gitea
  chart:
    spec:
      chart: gitea
      sourceRef:
        kind: HelmRepository
        name: bitnami
        namespace: flux-system
  interval: 1h
  install:
    remediation:
      retries: 3
  values:
    adminUsername: ${admin_username}
    adminPassword: ${admin_password}
    adminEmail: ${admin_email}
    appName: app_name
    persistence:
      existingClaim: gitea-pvc
    service:
      nodePorts:
        http: 30888
        ssh: 30822
    postgresql:
      enabled: false
    externalDatabase:
      host: ${db_host}
      port: ${db_port}
      user: ${db_user}
      database: ${db_name}
      password: ${db_password}